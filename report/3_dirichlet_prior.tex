\chapter{Corrected NBC with Dirichlet Prior}

\section{Theory}

We return to our likelihood function \cref{likelihood} for our theta variables.
We can introduce a prior distribution for these parameters and then consider the posterior distribution.

The Dirichlet distribution is the multinomial extension of the beta distribution for $\theta_1,\dots,\theta_k$ where $\theta_i \in (0,1)$ and $\sum_{i=1}^k \theta_i = 1$ with probability density function:
\begin{equation} \label{dirichlet_pdf}
	f(\theta_1,\dots,\theta_k \mid s, t(1),\dots,t(k)) \propto \prod_{i=1}^k \theta_i^{st(i) - 1}
\end{equation}
where $s > 0$ and each $t(i)>0$ such that $\sum_{i=1}^{k}t(i) = 1$.

We introduce a distribution that is similar to our likelihood as our prior density:
\begin{equation} \label{prior}
	f(\mathbf{\theta} \mid \mathbf{t}, s) \propto \prod_{c \in \mathcal{C}} \left[ \theta_c^{st(c) - 1} \prod_{i=1}^k \prod_{a_i \in \mathcal{A}_i} \theta_{a_i \mid c}^{st(c, a_i) - 1} \right]
\end{equation}
This is in the same form as the likelihood however each $n(\cdot)$ is replaces by $st(\cdot) - 1$.
$s > 0$ is a fixed constant and we have the following constraints on $t(\cdot):$
\begin{align}\label{prior_constraints}
	\sum_{c \in \mathcal{C}} t(c) & = 1 \\
	\sum_{a_i \in \mathcal{A}_i} t(a_i, c) & = t(c) && \forall i, c \\
	t(a_i, c) & > 0 && \forall i, a_i, c
\end{align}

This distribution is the conjugate prior for the likelihood function \cref{likelihood}.
When we multiply our likelihood by this prior density we get a posterior in the same family as this prior.
If the prior has hyper parameters $st(\cdot)$ the posterior will have hyper parameters $st(\cdot) + n(\cdot)$.

We can now estimate the parameters by taking the posterior expectation e.g.
\begin{align}
	E(\theta_c \mid \mathbf{n},s,\mathbf{t}) & = \frac{n(c) + st(c)}{N + s} = \hat{\theta}_c \\
	E(\theta_{a_i \mid c} \mid \mathbf{n},s,\mathbf{t}) & = \frac{n(c) + st(a_i, c)}{N + st(c)} = \hat{\theta}_{a_i \mid c}
\end{align}

\section{Application}

To apply this classifier to our data set we need to choose the hyper parameters of the prior distribution.
We note that $s$ affects the speed at which our classifier learns and $t(\cdot)$ represents our beliefs for $\theta_\cdot$.
We want our prior to be as uninformative as possible and assign the same probabilities to each chance\cite{laplace1812}. Therefore we set:
\begin{align}
	t(c) & = \frac{1}{|C|} \\
	t(a_i, c) & = \frac{1}{|A_i||C|}
\end{align}
Falling Walley's recommendation \cite{Walley96}, we also set $s=1$.

Previously we've considered the accuracy of our classifier.
An alternative metric is the mean squared error of our estimate.
\begin{equation}
	\text{MSE} = \frac{1}{n}\sum_{i=1}^n(\hat{c_i} - c_i)^2
\end{equation}

\begin{center}
	\begin{tabular}{ c|c c c c c c }
		              & Accuracy & MSE   & Random Classifications\\
		\hline
		NBC           & 59.95\%  & 2.823 & 22.45\% \\
		Corrected NBC & 68.17\%  & 0.689 & 0\%
	\end{tabular}
\end{center}

This again shows an improvement over the previous classifier.

\section{Conclusions}